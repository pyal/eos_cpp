      SUBROUTINE EOSE5(NMAT,RO,EE,PP,C,NF)
C     ---------- P=P(E,X), X=LN(V0/V) -----------
      REAL*4 NMET,NMAT,NF
      DIMENSION V0(20),DX(20),CMN(20),GM(20),GN(20),
     *ES(20),E0(20),A1(20),A2(20),A3(20),A4(20),A5(20),TA(20),
     *GC(20),GF(20),GI(20),QS(20),RS(20),SM(20),EA(20),CR(20),C1R(20)
      DATA R13/.3333333/,GGI/0.66667/
      DATA V0/
     *0.36899999E+00,0.12000000E+00,0.11200000E+00,0.11200000E+00,
     *0.97800002E-01,0.59700001E-01,0.51899999E-01,0.11400000E+00,
     *0.10600000E+00,0.68000004E-01,0.19100000E+00,0.37900001E+00,
     *0.25099999E+00,0.13500001E+00,0.27599999E+00,0.16800000E+00,
     *0.23400000E+00,0.28500000E+00,0.23400000E+00,0.28500000E+00/
      DATA DX/
     *0.97923768E+00,0.98654294E+00,0.98788840E+00,0.98512739E+00,
     *0.99516851E+00,0.99392873E+00,0.99559385E+00,0.99241948E+00,
     *0.99212933E+00,0.99379587E+00,0.99170280E+00,0.98593026E+00,
     *0.99903804E+00,0.99669880E+00,0.99571979E+00,0.99757433E+00,
     *0.99867040E+00,0.99555194E+00,0.99867040E+00,0.99555194E+00/
      DATA CMN/
     *0.13236355E+02,0.93907785E+01,0.40191025E+02,0.32090946E+02,
     *0.15142738E+02,0.55232449E+01,0.88132381E+01,0.82830400E+01,
     *0.73291235E+01,0.24444359E+02,0.94945831E+01,0.95852623E+01,
     *0.27481434E+02,0.81478615E+02,0.30039679E+02,0.14418982E+03,
     *-.65461633E+03,0.62411430E+02,-.65461633E+03,0.62411430E+02/
      DATA GM/
     *0.30000000E+01,0.30000000E+01,0.20000000E+01,0.20000000E+01,
     *0.30000000E+01,0.30000000E+01,0.30000000E+01,0.30000000E+01,
     *0.30000000E+01,0.30000000E+01,0.30000000E+01,0.30000000E+01,
     *0.30000000E+01,0.10000000E+01,0.20000000E+01,0.10000000E+01,
     *0.10000000E+01,0.30000000E+01,0.10000000E+01,0.30000000E+01/
      DATA GN/
     *0.79678911E+00,0.88841510E+00,0.14686743E+01,0.15083541E+01,
     *0.12716891E+01,0.89647323E+00,0.11707672E+01,0.78728539E+00,
     *0.77614015E+00,0.21540449E+01,0.75564569E+00,0.11521428E+00,
     *0.30822441E+00,0.50457835E+00,0.35332552E+00,0.41892529E+00,
     *0.11392233E+01,0.77238226E+00,0.11392233E+01,0.77238226E+00/
      DATA ES/
     *0.12200000E+02,0.74400001E+01,0.72700000E+01,0.52300000E+01,
     *0.68600001E+01,0.43200002E+01,0.45900002E+01,0.77600002E+01,
     *0.70000000E+01,0.32000000E+01,0.93999996E+01,0.80000000E+02,
     *0.80000000E+02,0.80000000E+02,0.70000000E+02,0.20000000E+03,
     *0.80000000E+02,0.60000000E+02,0.80000000E+02,0.60000000E+02/
      DATA E0/
     *0.27874136E+00,0.13305263E+00,0.12638156E+00,0.11601093E+00,
     *0.76778181E-01,0.40648099E-01,0.40003929E-01,0.78756474E-01,
     *0.73167540E-01,0.61340015E-01,0.14195748E+00,0.29866132E+00,
     *0.71229517E-01,0.12153089E+00,0.17655078E+00,0.92539147E-01,
     *0.12136304E+00,0.61373949E+00,0.12136304E+00,0.61373949E+00/
      DATA A1/
     *0.39950000E+03,-.10416100E+04,0.18928400E+04,-.65371002E+03,
     *0.45810999E+03,-.25452299E+02,-.40144601E+03,0.10986800E+03,
     *0.55237000E+03,-.65105003E+02,-.20227600E+03,0.45814001E+03,
     *-.81706201E+03,-.23358201E+04,0.55854999E+03,-.58477002E+04,
     *-.23182000E+04,-.15058000E+04,-.23182000E+04,-.15058000E+04/
      DATA A2/
     *-.11932000E+04,0.42018701E+04,-.45849902E+04,0.28425300E+04,
     *-.19048800E+04,-.31007999E+03,0.34389801E+03,-.64073798E+03,
     *-.15664399E+04,-.52196301E+03,0.13878900E+03,-.12964900E+04,
     *0.67171399E+03,0.42888901E+04,-.19695100E+04,0.15007200E+05,
     *0.37505901E+04,0.15794700E+04,0.37505901E+04,0.15794700E+04/
      DATA A3/
     *0.95741998E+03,-.60544502E+04,0.29190200E+04,-.44766201E+04,
     *0.16349200E+04,0.97382004E+02,-.44822000E+03,0.46110599E+03,
     *0.10084200E+04,0.30412299E+03,-.12711000E+02,0.10074200E+04,
     *0.23222800E+03,-.24967500E+04,0.17472500E+04,-.14435100E+05,
     *-.17300400E+04,-.11360000E+03,-.17300400E+04,-.11360000E+03/
      DATA A4/
     *-.17536000E+03,0.31672300E+04,-.23344000E+03,0.26115000E+04,
     *-.19434000E+03,0.24988499E+03,0.53452899E+03,0.74529999E+02,
     *0.79699998E+01,0.30006601E+03,0.80658997E+02,-.17992999E+03,
     *-.96350998E+02,0.57010999E+03,-.36014999E+03,0.57396001E+04,
     *0.31112000E+03,0.41990002E+02,0.31112000E+03,0.41990002E+02/
      DATA A5/
     *0.11640000E+02,-.27304001E+03,0.65700002E+01,-.32370001E+03,
     *0.61900001E+01,-.11734700E+02,-.28761000E+02,-.47659998E+01,
     *-.23299999E+01,-.17121000E+02,-.44610000E+01,0.10860000E+02,
     *0.94709997E+01,-.26430000E+02,0.23860001E+02,-.46400000E+03,
     *-.13470000E+02,-.20599999E+01,-.13470000E+02,-.20599999E+01/
      DATA TA/
     *-.14236578E+00,0.11153547E+01,0.12569865E+01,0.88387781E+00,
     *0.29956803E+00,0.10837162E+00,-.15780631E+00,0.78081071E-01,
     *0.65939009E+00,-.65091348E+00,0.59882182E+00,0.17009326E+01,
     *0.66994560E+00,-.22141452E+00,0.12732117E+01,-.17150369E+01,
     *0.17159620E+00,0.66216922E+00,0.17159620E+00,0.66216922E+00/
      DATA GC/
     *0.27288303E+02,0.21821798E+02,0.21987167E+03,0.20049946E+02,
     *0.29285833E+02,0.31841202E+02,0.18400175E+02,0.10437590E+02,
     *0.10111281E+02,0.14988029E+02,0.44505939E+01,0.98836164E+01,
     *0.47274499E+01,0.35086381E+01,0.26673777E+01,0.13154374E+02,
     *0.61608834E+01,0.46736064E+01,0.61608834E+01,0.46736064E+01/
      DATA GF/
     *0.10197377E+01,0.10031537E+01,0.10041945E+01,0.10064120E+01,
     *0.10030688E+01,0.10016240E+01,0.10016652E+01,0.10028082E+01,
     *0.10048698E+01,0.10040798E+01,0.10083537E+01,0.10049790E+01,
     *0.10007124E+01,0.10020262E+01,0.10035319E+01,0.10011556E+01,
     *0.10020235E+01,0.10076774E+01,0.10020235E+01,0.10076774E+01/
      DATA GI/
     *0.56000000E+00,0.47999999E+00,0.60000002E+00,0.50000000E+00,
     *0.55000001E+00,0.55000001E+00,0.38000000E+00,0.50000000E+00,
     *0.55000001E+00,0.60000002E+00,0.56999999E+00,0.50000000E+00,
     *0.44999999E+00,0.50000000E+00,0.40000001E+00,0.40000001E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.50000000E+00/
      DATA QS/
     *0.20000000E+01,0.22000000E+01,0.30000000E+01,0.20000000E+01,
     *0.30000000E+01,0.30000000E+01,0.20000000E+01,0.20000000E+01,
     *0.20000000E+01,0.20000000E+01,0.20000000E+01,0.20000000E+01,
     *0.20000000E+01,0.10000000E+01,0.10000000E+01,0.10000000E+01,
     *0.20000000E+01,0.20000000E+01,0.20000000E+01,0.20000000E+01/
      DATA RS/
     *0.50000000E+00,0.50000000E+00,0.10000000E+00,0.50000000E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.94999999E+00,
     *0.94999999E+00,0.98000002E+00,0.98000002E+00,0.50000000E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.50000000E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.50000000E+00/
      DATA SM/
     *0.79834861E+00,0.88114446E+00,0.86621022E+00,0.84973788E+00,
     *0.90510941E+00,0.90547884E+00,0.82472593E+00,0.84734094E+00,
     *0.85250831E+00,0.82101464E+00,0.89883494E+00,0.83532232E+00,
     *0.86599064E+00,0.57628471E+00,0.69222176E+00,0.56856394E+00,
     *0.80329502E+00,0.87264049E+00,0.80329502E+00,0.87264049E+00/
      DATA EA/
     *0.14000000E+02,0.42000000E+02,0.30000000E+02,0.18000000E+02,
     *0.25000000E+02,0.25000000E+02,0.24000000E+02,0.28000000E+02,
     *0.15000000E+02,0.15000000E+02,0.17000000E+02,0.60000000E+02,
     *0.10000000E+03,0.60000000E+02,0.50000000E+02,0.80000000E+02,
     *0.60000000E+02,0.80000000E+02,0.60000000E+02,0.80000000E+02/
      DATA CR/
     *0.45032949E+01,0.29177828E+01,0.41500125E+01,0.34478714E+01,
     *0.37076716E+01,0.35677252E+01,0.38610420E+01,0.31174524E+01,
     *0.16488583E+01,0.35280943E+01,0.17087576E+01,0.26236999E+01,
     *0.28202140E+01,0.31558793E+01,0.41985703E+01,0.61198440E+01,
     *0.48028069E+01,0.57818241E+01,0.77949209E+01,0.73283243E+01/
      DATA C1R/
     *0.16976650E+02,0.44948910E+01,0.52030000E+01,0.31223210E+01,
     *0.52076280E+01,0.39344720E+01,0.39021680E+01,0.25285980E+01,
     *0.81878880E+00,0.54940090E+01,0.18226360E+01,0.20840710E+01,
     *0.22750350E+01,0.30428180E+01,0.78179350E+01,0.19883870E+02,
     *0.14350050E+02,0.21697530E+02,0.40246150E+02,0.29583750E+02/
      NMET=NMAT
      E=EE
      X=ALOG(RO*V0(NMET))
      E=E+E0(NMET)
      VR=EXP(X)
      V=DX(NMET)*VR
      IF(1.-V) 4,4,1
C     --- Cold lattice contribution for liquid ---
    1 CM=0.
      IF(X.GT.-100./GM(NMET)) CM=CMN(NMET)*V**GM(NMET)
      CN=0.
      IF(X.GT.-100./GN(NMET)) CN=CMN(NMET)*V**GN(NMET)
      PX=CM-CN
      EX=CM/GM(NMET)-CN/GN(NMET)+ES(NMET)
      C2X=PX+CM*GM(NMET)-CN*GN(NMET)
      PX=PX*V/(V0(NMET)*DX(NMET))
      SQ=GC(NMET)*V**QS(NMET)
      SR=SQ*(V/SM(NMET))**RS(NMET)
      G=SQ/QS(NMET)
      GR=SR/(QS(NMET)+RS(NMET))
      GX=GGI+G-GR
      ET=E-EX
      G1X=SQ-SR
      GO TO 10
C     --- Cold lattice contribution for solid ---
    4 CONTINUE
      V13=V**R13
      V23=V13*V13
      V33=V
      V43=V23*V23
      V53=V23*V33
      V1=A1(NMET)*V13
      V2=A2(NMET)*V23
      V3=A3(NMET)*V33
      V4=A4(NMET)*V43
      V5=A5(NMET)*V53
      EX=3.*(V1-A1(NMET)+0.5*(V2-A2(NMET))+(V3-A3(NMET))/3.+
     +0.25*(V4-A4(NMET))+0.2*(V5-A5(NMET)))
      R0=V1+V2+V3+V4+V5
      R1=4./3.*V1+5./3.*V2+2.*V3+7./3.*V4+8./3.*V5
      R2=4./9.*V1+10./9.*V2+2.*V3+28./9.*V4+40./9.*V5
      R3=-8./27.*V1-10./27.*V2+28./27.*V4+80./27.*V5
      EX=EX*V0(NMET)*DX(NMET)
      PX=R0*V
      C2X=R1*V0(NMET)*DX(NMET)
      R3=R3+TA(NMET)*((R1*(TA(NMET)+1.)-R2)*3.-
     -R0*(TA(NMET)+1.)*(TA(NMET)+2.))
      R2=R2+TA(NMET)*(R0*(TA(NMET)+1.)-2.*R1)
      R1=R1-R0*TA(NMET)
      GR=R2/R1
      GX=.5*(TA(NMET)+GR+GGI)
      ET=E-EX
      G1X=.5*(GR*(1.-GR)+R3/R1)
   10 CONTINUE
C     --- Full pressure, sound speed and g calculations ---
      EAV=EA(NMET)*V**GGI
      V=V0(NMET)/VR
      G=GI(NMET)+(GX-GI(NMET))*GF(NMET)/(1.+ET/EAV)
      PT=G*ET/V
      P=PT+PX
      E=E-E0(NMET)
C     --- Check pressure position  ---
      IF(ET) 12,13,13
   12 NF=0
      P=1.E-8
      C2S=1.E-4
      GO TO 50
   13 NF=1
      IF(P.LT.1.E-4.AND.VR.LT.0.7) GOTO 20
      GOTO 21
   20 C2S=CR(NMET)*CR(NMET)*GI(NMET)*(ET+PT*V)/C1R(NMET)
      C2S=SIGN(SQRT(ABS(C2S)),C2S)
      GO TO 50
   21 CONTINUE
C     ----
      E1X=GGI*EA(NMET)
      GA=G-GF(NMET)*(GX-GI(NMET))/(1.+ET/EAV)/(1.+ET/EAV)*ET/EAV
      C2S=C2X+GA*P*V+G*(ET-PX*V)+ET*GF(NMET)/(1.+ET/EAV)*(G1X+
     +(GX-GI(NMET))/(ET+EAV)*(PX*V+ET*E1X/EAV))
      C2X=SIGN(SQRT(ABS(C2X)),C2X)
      C2S=SIGN(SQRT(ABS(C2S)),C2S)
   50 CONTINUE
      C=C2S
      PP=P
      RETURN
      END
      SUBROUTINE EOSP5(NMAT,RO,EE,PP,C,NF)
C     ---------- E=E(P,X), X=LN(V0/V) -----------
      REAL*4 NMET,NMAT,NF
      DIMENSION V0(20),DX(20),CMN(20),GM(20),GN(20),
     *ES(20),E0(20),A1(20),A2(20),A3(20),A4(20),A5(20),TA(20),
     *GC(20),GF(20),GI(20),QS(20),RS(20),SM(20),EA(20),CR(20),C1R(20)
      DATA R13/.3333333/,GGI/0.66667/
      DATA V0/
     *0.36899999E+00,0.12000000E+00,0.11200000E+00,0.11200000E+00,
     *0.97800002E-01,0.59700001E-01,0.51899999E-01,0.11400000E+00,
     *0.10600000E+00,0.68000004E-01,0.19100000E+00,0.37900001E+00,
     *0.25099999E+00,0.13500001E+00,0.27599999E+00,0.16800000E+00,
     *0.23400000E+00,0.28500000E+00,0.23400000E+00,0.28500000E+00/
      DATA DX/
     *0.97923768E+00,0.98654294E+00,0.98788840E+00,0.98512739E+00,
     *0.99516851E+00,0.99392873E+00,0.99559385E+00,0.99241948E+00,
     *0.99212933E+00,0.99379587E+00,0.99170280E+00,0.98593026E+00,
     *0.99903804E+00,0.99669880E+00,0.99571979E+00,0.99757433E+00,
     *0.99867040E+00,0.99555194E+00,0.99867040E+00,0.99555194E+00/
      DATA CMN/
     *0.13236355E+02,0.93907785E+01,0.40191025E+02,0.32090946E+02,
     *0.15142738E+02,0.55232449E+01,0.88132381E+01,0.82830400E+01,
     *0.73291235E+01,0.24444359E+02,0.94945831E+01,0.95852623E+01,
     *0.27481434E+02,0.81478615E+02,0.30039679E+02,0.14418982E+03,
     *-.65461633E+03,0.62411430E+02,-.65461633E+03,0.62411430E+02/
      DATA GM/
     *0.30000000E+01,0.30000000E+01,0.20000000E+01,0.20000000E+01,
     *0.30000000E+01,0.30000000E+01,0.30000000E+01,0.30000000E+01,
     *0.30000000E+01,0.30000000E+01,0.30000000E+01,0.30000000E+01,
     *0.30000000E+01,0.10000000E+01,0.20000000E+01,0.10000000E+01,
     *0.10000000E+01,0.30000000E+01,0.10000000E+01,0.30000000E+01/
      DATA GN/
     *0.79678911E+00,0.88841510E+00,0.14686743E+01,0.15083541E+01,
     *0.12716891E+01,0.89647323E+00,0.11707672E+01,0.78728539E+00,
     *0.77614015E+00,0.21540449E+01,0.75564569E+00,0.11521428E+00,
     *0.30822441E+00,0.50457835E+00,0.35332552E+00,0.41892529E+00,
     *0.11392233E+01,0.77238226E+00,0.11392233E+01,0.77238226E+00/
      DATA ES/
     *0.12200000E+02,0.74400001E+01,0.72700000E+01,0.52300000E+01,
     *0.68600001E+01,0.43200002E+01,0.45900002E+01,0.77600002E+01,
     *0.70000000E+01,0.32000000E+01,0.93999996E+01,0.80000000E+02,
     *0.80000000E+02,0.80000000E+02,0.70000000E+02,0.20000000E+03,
     *0.80000000E+02,0.60000000E+02,0.80000000E+02,0.60000000E+02/
      DATA E0/
     *0.27874136E+00,0.13305263E+00,0.12638156E+00,0.11601093E+00,
     *0.76778181E-01,0.40648099E-01,0.40003929E-01,0.78756474E-01,
     *0.73167540E-01,0.61340015E-01,0.14195748E+00,0.29866132E+00,
     *0.71229517E-01,0.12153089E+00,0.17655078E+00,0.92539147E-01,
     *0.12136304E+00,0.61373949E+00,0.12136304E+00,0.61373949E+00/
      DATA A1/
     *0.39950000E+03,-.10416100E+04,0.18928400E+04,-.65371002E+03,
     *0.45810999E+03,-.25452299E+02,-.40144601E+03,0.10986800E+03,
     *0.55237000E+03,-.65105003E+02,-.20227600E+03,0.45814001E+03,
     *-.81706201E+03,-.23358201E+04,0.55854999E+03,-.58477002E+04,
     *-.23182000E+04,-.15058000E+04,-.23182000E+04,-.15058000E+04/
      DATA A2/
     *-.11932000E+04,0.42018701E+04,-.45849902E+04,0.28425300E+04,
     *-.19048800E+04,-.31007999E+03,0.34389801E+03,-.64073798E+03,
     *-.15664399E+04,-.52196301E+03,0.13878900E+03,-.12964900E+04,
     *0.67171399E+03,0.42888901E+04,-.19695100E+04,0.15007200E+05,
     *0.37505901E+04,0.15794700E+04,0.37505901E+04,0.15794700E+04/
      DATA A3/
     *0.95741998E+03,-.60544502E+04,0.29190200E+04,-.44766201E+04,
     *0.16349200E+04,0.97382004E+02,-.44822000E+03,0.46110599E+03,
     *0.10084200E+04,0.30412299E+03,-.12711000E+02,0.10074200E+04,
     *0.23222800E+03,-.24967500E+04,0.17472500E+04,-.14435100E+05,
     *-.17300400E+04,-.11360000E+03,-.17300400E+04,-.11360000E+03/
      DATA A4/
     *-.17536000E+03,0.31672300E+04,-.23344000E+03,0.26115000E+04,
     *-.19434000E+03,0.24988499E+03,0.53452899E+03,0.74529999E+02,
     *0.79699998E+01,0.30006601E+03,0.80658997E+02,-.17992999E+03,
     *-.96350998E+02,0.57010999E+03,-.36014999E+03,0.57396001E+04,
     *0.31112000E+03,0.41990002E+02,0.31112000E+03,0.41990002E+02/
      DATA A5/
     *0.11640000E+02,-.27304001E+03,0.65700002E+01,-.32370001E+03,
     *0.61900001E+01,-.11734700E+02,-.28761000E+02,-.47659998E+01,
     *-.23299999E+01,-.17121000E+02,-.44610000E+01,0.10860000E+02,
     *0.94709997E+01,-.26430000E+02,0.23860001E+02,-.46400000E+03,
     *-.13470000E+02,-.20599999E+01,-.13470000E+02,-.20599999E+01/
      DATA TA/
     *-.14236578E+00,0.11153547E+01,0.12569865E+01,0.88387781E+00,
     *0.29956803E+00,0.10837162E+00,-.15780631E+00,0.78081071E-01,
     *0.65939009E+00,-.65091348E+00,0.59882182E+00,0.17009326E+01,
     *0.66994560E+00,-.22141452E+00,0.12732117E+01,-.17150369E+01,
     *0.17159620E+00,0.66216922E+00,0.17159620E+00,0.66216922E+00/
      DATA GC/
     *0.27288303E+02,0.21821798E+02,0.21987167E+03,0.20049946E+02,
     *0.29285833E+02,0.31841202E+02,0.18400175E+02,0.10437590E+02,
     *0.10111281E+02,0.14988029E+02,0.44505939E+01,0.98836164E+01,
     *0.47274499E+01,0.35086381E+01,0.26673777E+01,0.13154374E+02,
     *0.61608834E+01,0.46736064E+01,0.61608834E+01,0.46736064E+01/
      DATA GF/
     *0.10197377E+01,0.10031537E+01,0.10041945E+01,0.10064120E+01,
     *0.10030688E+01,0.10016240E+01,0.10016652E+01,0.10028082E+01,
     *0.10048698E+01,0.10040798E+01,0.10083537E+01,0.10049790E+01,
     *0.10007124E+01,0.10020262E+01,0.10035319E+01,0.10011556E+01,
     *0.10020235E+01,0.10076774E+01,0.10020235E+01,0.10076774E+01/
      DATA GI/
     *0.56000000E+00,0.47999999E+00,0.60000002E+00,0.50000000E+00,
     *0.55000001E+00,0.55000001E+00,0.38000000E+00,0.50000000E+00,
     *0.55000001E+00,0.60000002E+00,0.56999999E+00,0.50000000E+00,
     *0.44999999E+00,0.50000000E+00,0.40000001E+00,0.40000001E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.50000000E+00/
      DATA QS/
     *0.20000000E+01,0.22000000E+01,0.30000000E+01,0.20000000E+01,
     *0.30000000E+01,0.30000000E+01,0.20000000E+01,0.20000000E+01,
     *0.20000000E+01,0.20000000E+01,0.20000000E+01,0.20000000E+01,
     *0.20000000E+01,0.10000000E+01,0.10000000E+01,0.10000000E+01,
     *0.20000000E+01,0.20000000E+01,0.20000000E+01,0.20000000E+01/
      DATA RS/
     *0.50000000E+00,0.50000000E+00,0.10000000E+00,0.50000000E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.94999999E+00,
     *0.94999999E+00,0.98000002E+00,0.98000002E+00,0.50000000E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.50000000E+00,
     *0.50000000E+00,0.50000000E+00,0.50000000E+00,0.50000000E+00/
      DATA SM/
     *0.79834861E+00,0.88114446E+00,0.86621022E+00,0.84973788E+00,
     *0.90510941E+00,0.90547884E+00,0.82472593E+00,0.84734094E+00,
     *0.85250831E+00,0.82101464E+00,0.89883494E+00,0.83532232E+00,
     *0.86599064E+00,0.57628471E+00,0.69222176E+00,0.56856394E+00,
     *0.80329502E+00,0.87264049E+00,0.80329502E+00,0.87264049E+00/
      DATA EA/
     *0.14000000E+02,0.42000000E+02,0.30000000E+02,0.18000000E+02,
     *0.25000000E+02,0.25000000E+02,0.24000000E+02,0.28000000E+02,
     *0.15000000E+02,0.15000000E+02,0.17000000E+02,0.60000000E+02,
     *0.10000000E+03,0.60000000E+02,0.50000000E+02,0.80000000E+02,
     *0.60000000E+02,0.80000000E+02,0.60000000E+02,0.80000000E+02/
      DATA CR/
     *0.45032949E+01,0.29177828E+01,0.41500125E+01,0.34478714E+01,
     *0.37076716E+01,0.35677252E+01,0.38610420E+01,0.31174524E+01,
     *0.16488583E+01,0.35280943E+01,0.17087576E+01,0.26236999E+01,
     *0.28202140E+01,0.31558793E+01,0.41985703E+01,0.61198440E+01,
     *0.48028069E+01,0.57818241E+01,0.77949209E+01,0.73283243E+01/
      DATA C1R/
     *0.16976650E+02,0.44948910E+01,0.52030000E+01,0.31223210E+01,
     *0.52076280E+01,0.39344720E+01,0.39021680E+01,0.25285980E+01,
     *0.81878880E+00,0.54940090E+01,0.18226360E+01,0.20840710E+01,
     *0.22750350E+01,0.30428180E+01,0.78179350E+01,0.19883870E+02,
     *0.14350050E+02,0.21697530E+02,0.40246150E+02,0.29583750E+02/
      NMET=NMAT
      P=PP
      X=ALOG(RO*V0(NMET))
      VR=EXP(X)
      V=DX(NMET)*VR
      IF(1.-V) 2,2,1
C     --- Cold lattice contribution for liquid ---
    1 CM=0.
      IF(X.GT.-100./GM(NMET)) CM=CMN(NMET)*V**GM(NMET)
      CN=0.
      IF(X.GT.-100./GN(NMET)) CN=CMN(NMET)*V**GN(NMET)
      PX=CM-CN
      EX=CM/GM(NMET)-CN/GN(NMET)+ES(NMET)
      C2X=PX+CM*GM(NMET)-CN*GN(NMET)
      PX=PX*V/(V0(NMET)*DX(NMET))
      SQ=GC(NMET)*V**QS(NMET)
      SR=SQ*(V/SM(NMET))**RS(NMET)
      G=SQ/QS(NMET)
      GR=SR/(QS(NMET)+RS(NMET))
      GX=GGI+G-GR
      G1X=SQ-SR
      GO TO 3
C     --- Cold lattice contribution for solid ---
    2 CONTINUE
      V13=V**R13
      V23=V13*V13
      V33=V23*V13
      V43=V23*V23
      V53=V23*V33
      V1=A1(NMET)*V13
      V2=A2(NMET)*V23
      V3=A3(NMET)*V33
      V4=A4(NMET)*V43
      V5=A5(NMET)*V53
      EX=3.*(V1-1.+0.5*(V2-1.)+R13*(V2-1.)+
     +0.25*(V4-1.)+0.2*(V5-1.))
      R0=V1+V2+V3+V4+V5
      R1=4./3.*V1+5./3.*V2+2.*V3+7./3.*V4+8./3.*V5
      R2=4./9.*V1+10./9.*V2+2.*V3+28./9.*V4+40./9.*V5
      R3=-8./27.*V1-10./27.*V2+28./27.*V4+80./27.*V5
      EX=EX*V0(NMET)*DX(NMET)
      PX=R0*V
      C2X=R1*V0(NMET)*DX(NMET)
      R3=R3+TA(NMET)*((R1*(TA(NMET)+1.)-R2)*3.-
     -R0*(TA(NMET)+1.)*(TA(NMET)+2.))
      R2=R2+TA(NMET)*(R0*(TA(NMET)+1.)-2.*R1)
      R1=R1-R0*TA(NMET)
      GR=R2/R1
      GX=.5*(TA(NMET)+GR+GGI)
      G1X=.5*(GR*(1.-GR)+R3/R1)
    3 CONTINUE
C     --- Full pressure-sound speed calculations ---
      EAV=EA(NMET)*V**GGI
      V=V0(NMET)/VR
      PT=P-PX
C     --- Check pressure position  ---
      IF(PT) 12,13,13
   12 NF=0
      P=1.E-8
      C2S=1.E-4
      GO TO 50
   13 NF=1
C     ---
      B=(GX-GI(NMET))*GF(NMET)+GI(NMET)-PT*V/EAV
      D=SQRT(B*B+4.*GI(NMET)*PT*V/EAV)
      ET=(-B+D)*.5*EAV/GI(NMET)
      G=GI(NMET)+(GX-GI(NMET))*GF(NMET)/(1.+ET/EAV)
      E=EX+ET-E0(NMET)
      E1X=GGI*EA(NMET)
      GA=G-GF(NMET)*(GX-GI(NMET))/(1.+ET/EAV)/(1.+ET/EAV)*ET/EAV
      IF(P.LT.1.E-4.AND.VR.LT.0.7) GOTO 20
      GOTO 21
   20 C2S=CR(NMET)*CR(NMET)*(C2X+GI(NMET)*(ET+PT*V))/C1R(NMET)
      C2S=SIGN(SQRT(ABS(C2S)),C2S)
      GO TO 50
   21 CONTINUE
      C2S=C2X+GA*P*V+G*(ET-PX*V)+ET*GF(NMET)/(1.+ET/EAV)*(G1X+
     +(GX-GI(NMET))/(ET+EAV)*(PX*V+ET*E1X/EAV))
      C2X=SIGN(SQRT(ABS(C2X)),C2X)
      C2S=SIGN(SQRT(ABS(C2S)),C2S)
   50 CONTINUE
      C=C2S
      EE=E
      RETURN
      END
